# astrbot-plugin-seedream-image

火山方舟Seedream模型图片生成插件，适配AstrBot机器人框架，支持文生图、图生图功能。

## 功能特性
- 支持文生图：通过提示词生成高清图片
- 支持图生图：基于参考图片+提示词生成图片
- 自动校验图片尺寸，适配火山方舟像素要求
- 自动清理过期图片文件，节省磁盘空间
- 限流防重，避免重复请求和频率超限

## 安装部署
1. 将插件文件放入AstrBot的`plugins`目录下
2. 安装依赖（如未安装）：
   ```bash
   pip install aiohttp
   ```
3. 配置文件中填写必要参数（参考下方配置说明）

## 配置说明
在AstrBot面板中修改以下配置项：

```yaml
astrbot_plugin_seedream_image:
  # 火山方舟账号API KEY（必填）
  VOLC_API_KEY: ""
  # 火山方舟API访问端点（默认北京节点）
  VOLC_ENDPOINT: "https://ark.cn-beijing.volces.com/api/v3"
  # 生成图片尺寸（支持1920x1920/2048x2048/4096x4096等）
  image_size: "4096x4096"
  # Seedream模型版本
  model_version: "seedream-v1"
```

| 配置项 | 类型 | 说明 | 默认值 | 注意事项 |
|--------|------|------|--------|----------|
| VOLC_API_KEY | string | 火山方舟账号API KEY | 空 | 敏感信息，请勿泄露 |
| VOLC_ENDPOINT | string | API访问端点 | https://ark.cn-beijing.volces.com/api/v3 | 可根据地域调整域名 |
| image_size | string | 生成图片尺寸 | 4096x4096 | 最低要求1920x1920（3686400像素） |
| model_version | string | Seedream模型版本 | seedream-v1 | 需与账号开通的模型版本匹配 |

## 使用方法
### 基础指令
```
画图豆包 <提示词>
```

### 使用示例
1. **文生图**
   ```
   画图豆包 星空下的大海，高清，细节丰富
   ```

2. **图生图**
   - 发送图片 + 指令：
     ```
     画图豆包 将图片中的人物服装换成古风
     ```
   - 纯图片生成（无提示词）：
     ```
     画图豆包
     ```
     （需同时发送参考图片）

## 常见问题
### Q1: 提示"API KEY无效或未授权"
- 检查VOLC_API_KEY是否填写正确
- 确认API KEY已开通Seedream模型使用权限
- 验证API KEY是否过期

### Q2: 提示"参数错误：尺寸不符合要求"
- 图片尺寸需满足最低3686400像素（1920x1920）
- 避免使用1024x1024等低分辨率配置
- 最大支持8192x8192像素（需账号支持）

### Q3: 提示"调用频率超限"
- 插件内置10秒限流，请勿频繁发送请求
- 火山方舟API有调用频率限制，建议间隔1分钟以上

### Q4: 图生图生成失败
- 参考图片需为可访问的URL，避免防盗链图片
- 确保参考图片格式为JPG/PNG
- 图片大小建议不超过5MB

### Q5: 提示"下载失败 HTTP 400"
- 检查生成图片URL是否有效
- 确认网络可访问火山方舟存储域名
- 可能是防盗链限制，建议更换参考图片

## 注意事项
1. API KEY为敏感信息，请勿分享给第三方
2. 生成图片尺寸需符合火山方舟要求，否则会自动调整
3. 图生图功能仅支持公开可访问的图片URL
4. 插件会自动清理过期图片，如需保留请及时备份
5. 请遵守火山方舟平台使用规范，合理使用API

## 版本信息
- 当前版本：3.2.0
- 适配框架：AstrBot
- 支持功能：文生图、图生图、自动尺寸校验、自动文件清理


